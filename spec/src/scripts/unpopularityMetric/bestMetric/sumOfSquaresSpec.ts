// TODO: test everything, but in particular the condition for saving, and the spread parameters or not
