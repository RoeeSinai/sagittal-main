import { Id, Maybe, Zone } from "../../../../../../src/general"
import { JiSymbol, SagittalComma } from "../../../../../../src/sagittal"
import { getJiSymbol, Level } from "../../../../../../src/sagittal/notations/ji"
import { computeCaptureZone } from "../../../../../../src/sagittal/notations/ji/captureZone"
import { computeLevelJiSymbolIds } from "../../../../../../src/sagittal/notations/ji/levelsJiSymbolIds"

describe("capture zones", (): void => {
    it("Medium level capture zones check out", (): void => {
        const mediumLevelJiSymbolIds = computeLevelJiSymbolIds(Level.MEDIUM)

        const actual = mediumLevelJiSymbolIds.map((mediumLevelJiSymbolId: Id<JiSymbol>): Maybe<Zone> => {
            const jiSymbol = getJiSymbol(mediumLevelJiSymbolId)

            return computeCaptureZone(jiSymbol, Level.MEDIUM)
        })

        const expected = [
            [0.000000, 2.740244],
            [2.740244, 8.080207],
            [8.080207, 13.420170],
            [13.420170, 18.760133],
            [18.760133, 24.662198],
            [24.662198, 30.002161],
            [30.002161, 35.118091],
            [35.118091, 40.260512],
            [40.260512, 45.112497],
            [45.112497, 51.219540],
            [51.219540, 56.842503],
            [56.842503, 62.465465],
            [62.465465, 68.572508],
        ] as Array<Zone<SagittalComma>>
        expect(actual).toBeCloseToObject(expected)
    })

    it("High level capture zones check out", (): void => {
        const highLevelJiSymbolIds = computeLevelJiSymbolIds(Level.HIGH)

        const actual = highLevelJiSymbolIds.map((highLevelJiSymbolId: Id<JiSymbol>): Maybe<Zone> => {
            const jiSymbol = getJiSymbol(highLevelJiSymbolId)

            return computeCaptureZone(jiSymbol, Level.HIGH)
        })

        const expected = [
            [0.000000, 1.194465],
            [1.194465, 4.567073],
            [4.567073, 6.534428],
            [6.534428, 9.063884],
            [9.063884, 11.031239],
            [11.031239, 13.420170],
            [13.420170, 15.387525],
            [15.387525, 17.354880],
            [17.354880, 18.760133],
            [18.760133, 20.305912],
            [20.305912, 22.694843],
            [22.694843, 26.067451],
            [26.067451, 28.596908],
            [28.596908, 30.985839],
            [30.985839, 32.391092],
            [32.391092, 34.358447],
            [34.358447, 37.309479],
            [37.309479, 38.061940],
            [38.061940, 39.698410],
            [39.698410, 41.665765],
            [41.665765, 45.112497],
            [45.112497, 47.567830],
            [47.567830, 49.535184],
            [49.535184, 51.924115],
            [51.924115, 53.891470],
            [53.891470, 55.858825],
            [55.858825, 57.826180],
            [57.826180, 59.793535],
            [59.793535, 61.760890],
            [61.760890, 64.149821],
            [64.149821, 66.117175],
            [66.117175, 68.572508],
        ] as Array<Zone<SagittalComma>>
        expect(actual).toBeCloseToObject(expected)
    })

    it("Ultra level capture zones check out", (): void => {
        const ultraLevelJiSymbolIds = computeLevelJiSymbolIds(Level.ULTRA)

        const actual = ultraLevelJiSymbolIds.map((ultraLevelJiSymbolId: Id<JiSymbol>): Maybe<Zone> => {
            const jiSymbol = getJiSymbol(ultraLevelJiSymbolId)

            return computeCaptureZone(jiSymbol, Level.ULTRA)
        })

        const expected = [
            [0.000000, 1.194465],
            [1.194465, 1.756566],
            [1.756566, 2.740244],
            [2.740244, 4.567073],
            [4.567073, 6.534428],
            [6.534428, 7.096530],
            [7.096530, 8.080207],
            [8.080207, 9.063884],
            [9.063884, 11.031239],
            [11.031239, 12.014917],
            [12.014917, 12.436493],
            [12.436493, 13.420170],
            [13.420170, 15.387525],
            [15.387525, 17.354880],
            [17.354880, 18.760133],
            [18.760133, 19.743811],
            [19.743811, 20.305912],
            [20.305912, 22.694843],
            [22.694843, 23.116419],
            [23.116419, 23.955448],
            [23.955448, 24.885981],
            [24.885981, 26.067451],
            [26.067451, 28.596908],
            [28.596908, 30.002161],
            [30.002161, 30.985839],
            [30.985839, 31.407415],
            [31.407415, 32.391092],
            [32.391092, 34.358447],
            [34.358447, 35.118091],
            [35.118091, 36.325802],
            [36.325802, 37.309479],
            [37.309479, 37.871581],
            [37.871581, 38.061940],
            [38.061940, 39.698410],
            [39.698410, 40.260512],
            [40.260512, 41.665765],
            [41.665765, 44.195221],
            [44.195221, 45.112497],
            [45.112497, 47.567830],
            [47.567830, 49.535184],
            [49.535184, 49.956761],
            [49.956761, 51.219540],
            [51.219540, 51.924115],
            [51.924115, 53.891470],
            [53.891470, 55.095545],
            [55.095545, 55.858825],
            [55.858825, 57.826180],
            [57.826180, 58.589460],
            [58.589460, 59.793535],
            [59.793535, 61.760890],
            [61.760890, 62.465465],
            [62.465465, 63.728245],
            [63.728245, 64.149821],
            [64.149821, 66.117175],
            [66.117175, 68.572508],
        ] as Array<Zone<SagittalComma>>
        expect(actual).toBeCloseToObject(expected)
    })

    it("Extreme level capture zones check out", (): void => {
        const extremeLevelJiSymbolIds = computeLevelJiSymbolIds(Level.EXTREME)

        const actual = extremeLevelJiSymbolIds.map((extremeLevelJiSymbolId: Id<JiSymbol>): Maybe<Zone> => {
            const jiSymbol = getJiSymbol(extremeLevelJiSymbolId)

            return computeCaptureZone(jiSymbol, Level.EXTREME)
        })

        const expected = [
            [0.000000, 0.210788],
            [0.210788, 0.772889],
            [0.772889, 1.194465],
            [1.194465, 1.756566],
            [1.756566, 2.178142],
            [2.178142, 2.740244],
            [2.740244, 3.161820],
            [3.161820, 3.723921],
            [3.723921, 4.145497],
            [4.145497, 4.567073],
            [4.567073, 5.129175],
            [5.129175, 5.550751],
            [5.550751, 6.112852],
            [6.112852, 6.534428],
            [6.534428, 7.096530],
            [7.096530, 7.518106],
            [7.518106, 8.080207],
            [8.080207, 8.501783],
            [8.501783, 9.063884],
            [9.063884, 9.485460],
            [9.485460, 10.047562],
            [10.047562, 10.469138],
            [10.469138, 11.031239],
            [11.031239, 11.452815],
            [11.452815, 12.014917],
            [12.014917, 12.436493],
            [12.436493, 12.998594],
            [12.998594, 13.420170],
            [13.420170, 13.841746],
            [13.841746, 14.403848],
            [14.403848, 14.825424],
            [14.825424, 15.387525],
            [15.387525, 15.809101],
            [15.809101, 16.371202],
            [16.371202, 16.792779],
            [16.792779, 17.354880],
            [17.354880, 17.776456],
            [17.776456, 18.338557],
            [18.338557, 18.760133],
            [18.760133, 19.322235],
            [19.322235, 19.743811],
            [19.743811, 20.305912],
            [20.305912, 20.727488],
            [20.727488, 21.289590],
            [21.289590, 21.711166],
            [21.711166, 22.132742],
            [22.132742, 22.694843],
            [22.694843, 23.116419],
            [23.116419, 23.678521],
            [23.678521, 23.955448],
            [23.955448, 24.100097],
            [24.100097, 24.662198],
            [24.662198, 24.885981],
            [24.885981, 25.083774],
            [25.083774, 25.645875],
            [25.645875, 26.067451],
            [26.067451, 26.629553],
            [26.629553, 27.051129],
            [27.051129, 27.613230],
            [27.613230, 28.034806],
            [28.034806, 28.596908],
            [28.596908, 29.018484],
            [29.018484, 29.580585],
            [29.580585, 30.002161],
            [30.002161, 30.564263],
            [30.564263, 30.985839],
            [30.985839, 31.407415],
            [31.407415, 31.969516],
            [31.969516, 32.391092],
            [32.391092, 32.953193],
            [32.953193, 33.374770],
            [33.374770, 33.936871],
            [33.936871, 34.358447],
            [34.358447, 34.920548],
            [34.920548, 35.118091],
            [35.118091, 35.342124],
            [35.342124, 35.904226],
            [35.904226, 36.325802],
            [36.325802, 36.887903],
            [36.887903, 37.309479],
            [37.309479, 37.871581],
            [37.871581, 38.061940],
            [38.061940, 38.293157],
            [38.293157, 38.855258],
            [38.855258, 39.276834],
            [39.276834, 39.698410],
            [39.698410, 40.260512],
            [40.260512, 40.682088],
            [40.682088, 41.244189],
            [41.244189, 41.665765],
            [41.665765, 42.227866],
            [42.227866, 42.649442],
            [42.649442, 43.211544],
            [43.211544, 43.633120],
            [43.633120, 44.195221],
            [44.195221, 44.616797],
            [44.616797, 45.112497],
            [45.112497, 45.600475],
            [45.600475, 46.162576],
            [46.162576, 46.584152],
            [46.584152, 47.146254],
            [47.146254, 47.567830],
            [47.567830, 48.129931],
            [48.129931, 48.551507],
            [48.551507, 48.973083],
            [48.973083, 49.535184],
            [49.535184, 49.956761],
            [49.956761, 50.518862],
            [50.518862, 50.940438],
            [50.940438, 51.219540],
            [51.219540, 51.502539],
            [51.502539, 51.924115],
            [51.924115, 52.486217],
            [52.486217, 52.907793],
            [52.907793, 53.469894],
            [53.469894, 53.891470],
            [53.891470, 54.453572],
            [54.453572, 54.875148],
            [54.875148, 55.095545],
            [55.095545, 55.437249],
            [55.437249, 55.858825],
            [55.858825, 56.420926],
            [56.420926, 56.842503],
            [56.842503, 57.264079],
            [57.264079, 57.826180],
            [57.826180, 58.247756],
            [58.247756, 58.589460],
            [58.589460, 58.809857],
            [58.809857, 59.231433],
            [59.231433, 59.793535],
            [59.793535, 60.215111],
            [60.215111, 60.777212],
            [60.777212, 61.198788],
            [61.198788, 61.760890],
            [61.760890, 62.182466],
            [62.182466, 62.465465],
            [62.465465, 62.744567],
            [62.744567, 63.166143],
            [63.166143, 63.728245],
            [63.728245, 64.149821],
            [64.149821, 64.711922],
            [64.711922, 65.133498],
            [65.133498, 65.555074],
            [65.555074, 66.117175],
            [66.117175, 66.538752],
            [66.538752, 67.100853],
            [67.100853, 67.522429],
            [67.522429, 68.084530],
            [68.084530, 68.572508],
        ] as Array<Zone<SagittalComma>>
        expect(actual).toBeCloseToObject(expected)
    })
})
